(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[142],{1446:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/jobs",function(){return t(1620)}])},1620:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var r=t(5893),n=t(7294),a=t(9008),d=t.n(a),i=t(1664),c=t.n(i),l=t(9392),o=t(9768),x=t(9315),m=t(1586),p=t(597),u=t(7119),h=t(113),y=t(2914),g=t(705),b=t(7344),f=t(9638),j=t(6615);function w(){let[e,s]=(0,n.useState)([]),[t,a]=(0,n.useState)("all"),[i,w]=(0,n.useState)(""),[N,v]=(0,n.useState)(1);(0,n.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("orders_data");if(e){let t=JSON.parse(e),r=[];t.forEach(e=>{e.items&&e.items.length>0&&e.items.forEach((s,t)=>{var n;let a=s.specificJob&&s.specificJob.type,d=a?s.specificJob:e.jobInfo;if(!d)return;let i=e.status||"Pending",c="installation"===d.type?"ติดตั้ง":"delivery"===d.type?"ส่งของ":d.type;r.push({uniqueId:"".concat(e.id,"-").concat(t+1),orderId:e.id,customer:e.customer?e.customer.name:"Unknown",product:s,jobType:c,rawJobType:d.type,appointmentDate:d.dateTime||"-",team:d.team||"-",inspector:(null===(n=d.inspector1)||void 0===n?void 0:n.name)||"-",address:d.installAddress||"-",status:i,priority:"Medium"})})}),r.sort((e,s)=>"-"===e.appointmentDate?1:"-"===s.appointmentDate?-1:new Date(e.appointmentDate)-new Date(s.appointmentDate)),s(r)}};return e(),window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);let k=e.filter(e=>{let s=e.orderId.toLowerCase().includes(i.toLowerCase())||e.customer.toLowerCase().includes(i.toLowerCase())||e.product.name&&e.product.name.toLowerCase().includes(i.toLowerCase())||e.team&&e.team.toLowerCase().includes(i.toLowerCase());if(!s)return!1;switch(t){case"pending-install":return"installation"===e.rawJobType&&"Completed"!==e.status;case"pending-delivery":return"delivery"===e.rawJobType&&"Completed"!==e.status;case"completed":return"Completed"===e.status;default:return!0}}),C=Math.ceil(k.length/15),Z=k.slice((N-1)*15,15*N),z={pendingInstall:e.filter(e=>"installation"===e.rawJobType&&"Completed"!==e.status).length,pendingDelivery:e.filter(e=>"delivery"===e.rawJobType&&"Completed"!==e.status).length,completed:e.filter(e=>"Completed"===e.status).length,total:e.length},D=e=>{switch(e){case"installation":return"bg-danger-50 text-danger-700 border-danger-100";case"delivery":return"bg-warning-50 text-warning-700 border-warning-100";default:return"bg-secondary-50 text-secondary-700 border-secondary-100"}},T=e=>{switch(null==e?void 0:e.toLowerCase()){case"completed":return"bg-success-100 text-success-700";case"processing":return"bg-primary-100 text-primary-700";default:return"bg-secondary-100 text-secondary-700"}};return(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(d(),{children:(0,r.jsx)("title",{children:"คิวงานติดตั้งและจัดส่ง - 168VSC System"})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-secondary-900 flex items-center gap-3",children:[(0,r.jsx)(o.Z,{className:"text-primary-600",size:32}),"คิวงานติดตั้งและจัดส่ง"]}),(0,r.jsxs)("p",{className:"text-secondary-500 mt-1",children:["จัดการคิวงานทั้งหมด ",e.length," รายการ"]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{onClick:()=>a("pending-install"),className:"bg-white p-5 rounded-xl border transition-all cursor-pointer hover:shadow-md ".concat("pending-install"===t?"border-danger-500 ring-1 ring-danger-500":"border-secondary-200 hover:border-danger-300"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-danger-600 text-sm font-medium",children:"คิวติดตั้งที่เหลือ"}),(0,r.jsx)("div",{className:"p-2 bg-danger-50 rounded-lg text-danger-600",children:(0,r.jsx)(x.Z,{size:20})})]}),(0,r.jsx)("div",{className:"text-3xl font-bold text-danger-700",children:z.pendingInstall})]}),(0,r.jsxs)("div",{onClick:()=>a("pending-delivery"),className:"bg-white p-5 rounded-xl border transition-all cursor-pointer hover:shadow-md ".concat("pending-delivery"===t?"border-warning-500 ring-1 ring-warning-500":"border-secondary-200 hover:border-warning-300"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-warning-600 text-sm font-medium",children:"คิวจัดส่งที่เหลือ"}),(0,r.jsx)("div",{className:"p-2 bg-warning-50 rounded-lg text-warning-600",children:(0,r.jsx)(m.Z,{size:20})})]}),(0,r.jsx)("div",{className:"text-3xl font-bold text-warning-700",children:z.pendingDelivery})]}),(0,r.jsxs)("div",{onClick:()=>a("completed"),className:"bg-white p-5 rounded-xl border transition-all cursor-pointer hover:shadow-md ".concat("completed"===t?"border-success-500 ring-1 ring-success-500":"border-secondary-200 hover:border-success-300"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-success-600 text-sm font-medium",children:"งานที่เสร็จแล้ว"}),(0,r.jsx)("div",{className:"p-2 bg-success-50 rounded-lg text-success-600",children:(0,r.jsx)(p.Z,{size:20})})]}),(0,r.jsx)("div",{className:"text-3xl font-bold text-success-700",children:z.completed})]}),(0,r.jsxs)("div",{onClick:()=>a("all"),className:"bg-white p-5 rounded-xl border transition-all cursor-pointer hover:shadow-md ".concat("all"===t?"border-primary-500 ring-1 ring-primary-500":"border-secondary-200 hover:border-primary-300"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-secondary-500 text-sm font-medium",children:"งานทั้งหมด"}),(0,r.jsx)("div",{className:"p-2 bg-secondary-50 rounded-lg text-secondary-600",children:(0,r.jsx)(o.Z,{size:20})})]}),(0,r.jsx)("div",{className:"text-3xl font-bold text-secondary-900",children:z.total})]})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-xl border border-secondary-200 shadow-sm flex flex-col sm:flex-row gap-4 items-center justify-between",children:[(0,r.jsxs)("div",{className:"relative flex-1 w-full",children:[(0,r.jsx)(u.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-secondary-400",size:20}),(0,r.jsx)("input",{type:"text",placeholder:"ค้นหา Order ID, ลูกค้า, สินค้า, ทีม...",value:i,onChange:e=>{w(e.target.value),v(1)},className:"w-full pl-10 pr-4 py-2 border border-secondary-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 transition-shadow"})]}),(0,r.jsx)("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-secondary-50 rounded-lg border border-secondary-200 text-secondary-600 text-sm font-medium",children:[(0,r.jsx)(h.Z,{size:16}),(0,r.jsxs)("span",{children:["ตัวกรอง: ","all"===t?"ทั้งหมด":"pending-install"===t?"งานติดตั้ง":"pending-delivery"===t?"งานส่งของ":"เสร็จสิ้น"]})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-secondary-50 border-b border-secondary-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary-600 uppercase tracking-wider",children:"Order ID"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary-600 uppercase tracking-wider",children:"ลูกค้า"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary-600 uppercase tracking-wider",children:"สินค้า"}),(0,r.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-secondary-600 uppercase tracking-wider",children:"ประเภทงาน"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary-600 uppercase tracking-wider",children:"วันที่นัดหมาย"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary-600 uppercase tracking-wider",children:"ทีมช่าง"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary-600 uppercase tracking-wider",children:"ผู้ตรวจงาน"}),(0,r.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-secondary-600 uppercase tracking-wider",children:"สถานะ"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-secondary-100",children:Z.length>0?Z.map((e,s)=>(0,r.jsxs)("tr",{className:"hover:bg-secondary-50 transition-colors",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)(c(),{href:"/order?id=".concat(e.orderId),className:"font-mono font-medium text-primary-600 hover:text-primary-700 hover:underline",children:e.orderId})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-secondary-900",children:e.customer})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg border border-secondary-200 overflow-hidden bg-secondary-50 flex-shrink-0 flex items-center justify-center",children:e.product.image?(0,r.jsx)("img",{src:e.product.image,alt:e.product.name,className:"w-full h-full object-cover"}):(0,r.jsx)(y.Z,{size:16,className:"text-secondary-300"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-secondary-900 line-clamp-1",children:e.product.name}),(0,r.jsx)("div",{className:"text-xs text-secondary-500 font-mono",children:e.product.id})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ".concat(D(e.rawJobType)),children:["installation"===e.rawJobType?(0,r.jsx)(x.Z,{size:12,className:"mr-1"}):"delivery"===e.rawJobType?(0,r.jsx)(m.Z,{size:12,className:"mr-1"}):null,e.jobType]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-secondary-600",children:[(0,r.jsx)(g.Z,{size:14,className:"text-secondary-400"}),"-"!==e.appointmentDate?new Date(e.appointmentDate).toLocaleString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-secondary-600",children:[(0,r.jsx)(b.Z,{size:14,className:"text-secondary-400"}),e.team]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-secondary-600",children:e.inspector})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(T(e.status)),children:e.status})})]},s)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"8",className:"px-6 py-12 text-center text-secondary-500",children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsx)(o.Z,{size:48,className:"text-secondary-300 mb-4"}),(0,r.jsx)("p",{className:"text-lg font-medium text-secondary-900",children:"ไม่พบข้อมูลคิวงาน"}),(0,r.jsx)("p",{className:"text-sm text-secondary-500 mt-1",children:"ลองเปลี่ยนตัวกรอง หรือค้นหาใหม่"})]})})})})]})}),C>1&&(0,r.jsxs)("div",{className:"px-6 py-4 border-t border-secondary-200 flex items-center justify-between bg-secondary-50",children:[(0,r.jsxs)("div",{className:"text-sm text-secondary-600",children:["แสดง ",(N-1)*15+1," - ",Math.min(15*N,k.length)," จาก ",k.length," รายการ"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>v(e=>Math.max(1,e-1)),disabled:1===N,className:"p-2 border border-secondary-300 rounded-lg text-secondary-600 hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,r.jsx)(f.Z,{size:18})}),(0,r.jsxs)("span",{className:"text-sm font-medium text-secondary-700 px-2",children:["หน้า ",N," / ",C]}),(0,r.jsx)("button",{onClick:()=>v(e=>Math.min(C,e+1)),disabled:N===C,className:"p-2 border border-secondary-300 rounded-lg text-secondary-600 hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,r.jsx)(j.Z,{size:18})})]})]})]})]})]})}},705:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var r=t(8387);let n=(0,r.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},7344:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var r=t(8387);let n=(0,r.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[424,956,774,888,179],function(){return e(e.s=1446)}),_N_E=e.O()}]);